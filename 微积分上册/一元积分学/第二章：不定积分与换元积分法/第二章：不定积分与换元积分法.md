### 2.1 不定积分的概念

#### 2.1.1 原函数与不定积分的定义

在第一章中，我们学习了微积分基本定理，它告诉我们，如果 $F(x)$ 是连续函数 $f(x)$ 的一个原函数，那么：

$$\int_a^b f(x) dx = F(b) - F(a)$$

这里，$F(x)$ 称为 $f(x)$ 的**原函数**。 那么，什么是原函数呢？

**定义：**  如果在区间 $I$ 上，可导函数 $F(x)$ 的导函数为 $f(x)$，即对任意 $x \in I$，都有 $F'(x) = f(x)$，那么称 $F(x)$ 为 $f(x)$ 在区间 $I$ 上的一个**原函数**。

**例 2.1.1**  因为 $(\sin x)' = \cos x$，所以 $\sin x$ 是 $\cos x$ 的一个原函数。

**例 2.1.2**  因为 $(\frac{1}{3}x^3)' = x^2$，所以 $\frac{1}{3}x^3$ 是 $x^2$ 的一个原函数。

**思考：**  如果 $F(x)$ 是 $f(x)$ 的一个原函数，那么 $F(x) + C$ ($C$ 为任意常数) 是否也是 $f(x)$ 的原函数呢？

答案是肯定的。 因为 $(F(x) + C)' = F'(x) + 0 = f(x)$。 这说明，如果一个函数存在原函数，那么它必定有无穷多个原函数，且这些原函数之间只相差一个常数。

**定义：**  在区间 $I$ 上，函数 $f(x)$ 的带有任意常数项的原函数称为 $f(x)$ 在区间 $I$ 上的**不定积分**，记作：

$$\int f(x) dx$$

其中，$\int$ 称为**积分号**，$f(x)$ 称为**被积函数**，$x$ 称为**积分变量**，$f(x)dx$ 称为**被积表达式**。

如果 $F(x)$ 是 $f(x)$ 的一个原函数，那么 $f(x)$ 的不定积分可以表示为：

$$\int f(x) dx = F(x) + C$$

其中 $C$ 是任意常数，称为**积分常数**。

**数学公式 (LaTeX):**

```latex
\int f(x) dx = F(x) + C
```

#### 2.1.2 不定积分的几何意义

从几何上看，函数 $f(x)$ 的不定积分表示一族曲线，这族曲线对应于 $f(x)$ 的所有原函数，它们之间只相差一个常数。 这意味着，这族曲线在 $x$ 处的切线斜率都相同，都等于 $f(x)$。

**图形描述：** 想象一系列形状相同，但上下位置不同的曲线。 在 $x$ 处，这些曲线的切线都相互平行，因为它们的斜率都等于 $f(x)$。 这一族曲线就代表了 $f(x)$ 的不定积分。

**(Obsidian 绘图建议：)**  你可以尝试在 Obsidian 中使用 Excalidraw 插件绘制几条形状相同，但上下位置不同的曲线，并在每条曲线上选取 $x$ 相同的位置，画出切线，验证它们的斜率是否相同。

#### 2.1.3 不定积分与定积分的关系

*   **联系：**  牛顿-莱布尼茨公式 $\int_a^b f(x) dx = F(b) - F(a)$ 表明，定积分可以通过不定积分 (原函数) 来计算。
*   **区别：**
    *   不定积分是一个函数族，而定积分是一个确定的值。
    *   不定积分 $\int f(x) dx$ 中没有积分上下限，而定积分 $\int_a^b f(x) dx$ 中有积分上下限。
    *   不定积分的结果包含任意常数 $C$，而定积分的结果是一个确定的数值，与积分常数 $C$ 无关。

---

### 2.2 基本积分表

正如乘法和除法互为逆运算一样，求导和求不定积分也互为逆运算。 我们可以利用已知的求导公式，得到相应的不定积分公式。

以下是一些基本的不定积分公式 (也称**基本积分表**)，这些公式需要熟练掌握：

| 序号  | 函数                         | 不定积分                          | 序号  | 函数                              | 不定积分          |                                 |              |
| --- | -------------------------- | ----------------------------- | --- | ------------------------------- | ------------- | ------------------------------- | ------------ |
| 1   | $k$ (常数)                   | $kx + C$                      | 9   | $\cos x$                        | $\sin x + C$  |                                 |              |
| 2   | $x^\mu$ ($\mu \neq -1$)    | $\frac{x^{\mu+1}}{\mu+1} + C$ | 10  | $\sin x$                        | $-\cos x + C$ |                                 |              |
| 3   | $\frac{1}{x}$              | $\ln                           x    + C$                            | 11            | $\frac{1}{\cos^2 x} = \sec^2 x$ | $\tan x + C$ |
| 4   | $e^x$                      | $e^x + C$                     | 12  | $\frac{1}{\sin^2 x} = \csc^2 x$ | $-\cot x + C$ |                                 |              |
| 5   | $a^x$ ($a > 0, a \neq 1$)  | $\frac{a^x}{\ln a} + C$       | 13  | $\sec x \tan x$                 | $\sec x + C$  |                                 |              |
| 6   | $\frac{1}{1+x^2}$          | $\arctan x + C$               | 14  | $\csc x \cot x$                 | $-\csc x + C$ |                                 |              |
| 7   | $\frac{1}{\sqrt{1-x^2}}$   | $\arcsin x + C$               | 15  | $\tan x$                        | $-\ln          \cos x                           + C$         |
| 8   | $\frac{1}{\sqrt{a^2-x^2}}$ | $\arcsin \frac{x}{a} + C$     | 16  | $\cot x$                        | $\ln           \sin x                           + C$         |
|     |                            |                               | 17  | $\sec x$                        | $\ln           \sec x + \tan x                  + C$         |
|     |                            |                               | 18  | $\csc x$                        | $\ln          \csc x - \cot x                  + C$         |

**表格说明：**

*   上述公式中，$C$ 都是积分常数。
*   公式 2 对 $\mu$ 的限制是必要的，因为当 $\mu = -1$ 时，分母为 0。
*   公式 8 可以通过公式 7 的变量代换推导得到。
*   公式 15-18 需要通过后续学习的换元积分法或分部积分法推导得出，这里先列出来供参考。

**记忆技巧：**  熟记这些基本积分公式，最好的办法是通过大量的练习。 可以尝试自己推导这些公式，或者制作积分卡片，随时记忆。

---

### 2.3 换元积分法

掌握了基本积分表，我们只能求解一些简单的函数的不定积分。 对于更复杂的函数，我们需要使用一些积分技巧，其中最重要的就是**换元积分法**。

换元积分法的基本思想是：通过变量代换，将一个复杂的积分转化为一个简单的积分，从而使问题得到解决。

换元积分法分为两类：**第一类换元法 (凑微分法)** 和 **第二类换元法 (变量代换法)**。

#### 2.3.1 第一类换元法 (凑微分法)

第一类换元法的核心思想是 “凑微分”。 通过观察被积表达式，将其中一部分 “凑” 成某个函数的微分，从而将积分变量转化为该函数。

**定理：** 设 $f(u)$ 具有原函数 $F(u)$，即 $\int f(u) du = F(u) + C$，$u = \phi(x)$ 可导，则：

$$\int f(\phi(x)) \phi'(x) dx = \int f(u) du \Big|_{u = \phi(x)} = F(\phi(x)) + C$$

**公式解释：**

*   左边的被积表达式中，$\phi'(x) dx$ 恰好是 $u = \phi(x)$ 的微分，即 $du = \phi'(x) dx$。
*   通过将 $\phi(x)$ 替换成 $u$，$\phi'(x) dx$ 替换成 $du$，我们就将关于 $x$ 的积分转化成了关于 $u$ 的积分。
*   求出 $\int f(u) du = F(u) + C$ 后，再将 $u$ 换回 $\phi(x)$，就得到了最终的结果。

**步骤：**

1. 观察被积表达式，找到合适的 $u = \phi(x)$，并计算 $du = \phi'(x) dx$。
2. 将 $x$ 和 $dx$ 换成 $u$ 和 $du$，得到关于 $u$ 的积分 $\int f(u) du$。
3. 求出 $\int f(u) du$。
4. 将 $u$ 换回 $\phi(x)$，得到最终结果。

**例 2.3.1** 求 $\int \sin(2x+1) dx$。

**解：**

设 $u = 2x + 1$，则 $du = 2 dx$，即 $dx = \frac{1}{2} du$。

$$\int \sin(2x+1) dx = \int \sin u \cdot \frac{1}{2} du = \frac{1}{2} \int \sin u du = -\frac{1}{2} \cos u + C$$

将 $u = 2x + 1$ 代回，得到：

$$\int \sin(2x+1) dx = -\frac{1}{2} \cos(2x+1) + C$$

**例 2.3.2** 求 $\int \frac{x}{1+x^2} dx$。

**解：**

设 $u = 1 + x^2$，则 $du = 2x dx$，即 $x dx = \frac{1}{2} du$。

$$\int \frac{x}{1+x^2} dx = \int \frac{1}{u} \cdot \frac{1}{2} du = \frac{1}{2} \int \frac{1}{u} du = \frac{1}{2} \ln |u| + C$$

将 $u = 1 + x^2$ 代回，得到：

$$\int \frac{x}{1+x^2} dx = \frac{1}{2} \ln(1+x^2) + C$$

**例 2.3.3** 求 $\int \tan x dx$。

**解：**

$$\int \tan x dx = \int \frac{\sin x}{\cos x} dx$$

设 $u = \cos x$，则 $du = -\sin x dx$。

$$\int \frac{\sin x}{\cos x} dx = -\int \frac{1}{u} du = -\ln |u| + C$$

将 $u = \cos x$ 代回，得到：

$$\int \tan x dx = -\ln |\cos x| + C$$

**技巧：** 凑微分法的关键在于观察被积表达式，找出合适的 $u = \phi(x)$。 通常，我们需要将 $f(\phi(x))$ 中的 $\phi(x)$ 看作一个整体，并尝试将 $\phi'(x) dx$ 凑成 $du$。 多加练习，才能熟练掌握凑微分的技巧。

---

#### 2.3.2 第二类换元法 (变量代换法)

与第一类换元法 (凑微分法) 不同，第二类换元法是通过引入一个新的变量 $x = \psi(t)$，将原来的积分变量 $x$ 替换成新变量 $t$ 的函数，从而将积分化简。

**定理：** 设 $x = \psi(t)$ 是单调的、可导的函数，并且 $\psi'(t) \neq 0$。 又设 $f[\psi(t)]\psi'(t)$ 具有原函数 $\Phi(t)$，则：

$$\int f(x) dx = \int f[\psi(t)]\psi'(t) dt = \Phi(t) + C = \Phi[\psi^{-1}(x)] + C$$

其中 $\psi^{-1}(x)$ 是 $x = \psi(t)$ 的反函数。

**公式解释：**

*   我们引入一个新的变量 $t$，并令 $x = \psi(t)$。
*   将 $x$ 换成 $\psi(t)$，将 $dx$ 换成 $\psi'(t)dt$，从而得到关于 $t$ 的积分 $\int f[\psi(t)]\psi'(t) dt$。
*   求出 $\int f[\psi(t)]\psi'(t) dt = \Phi(t) + C$。
*   由于 $x = \psi(t)$ 单调，所以存在反函数 $t = \psi^{-1}(x)$。 将 $t$ 换回 $\psi^{-1}(x)$，得到最终结果。

**步骤：**

1. 选择合适的变量代换 $x = \psi(t)$，并计算 $dx = \psi'(t) dt$。
2. 将 $x$ 和 $dx$ 换成 $t$ 和 $dt$，得到关于 $t$ 的积分 $\int f[\psi(t)]\psi'(t) dt$。
3. 求出 $\int f[\psi(t)]\psi'(t) dt$。
4. 将 $t$ 换回 $\psi^{-1}(x)$，得到最终结果。

**例 2.3.4** 求 $\int \frac{1}{1+\sqrt{x}} dx$。

**解：**

设 $\sqrt{x} = t$，则 $x = t^2$， $dx = 2t dt$。

$$\int \frac{1}{1+\sqrt{x}} dx = \int \frac{1}{1+t} 2t dt = 2 \int \frac{t}{1+t} dt = 2 \int \left( 1 - \frac{1}{1+t} \right) dt$$

$$= 2(t - \ln|1+t|) + C$$

将 $t = \sqrt{x}$ 代回，得到：

$$\int \frac{1}{1+\sqrt{x}} dx = 2(\sqrt{x} - \ln|1+\sqrt{x}|) + C$$

**例 2.3.5** 求 $\int \sqrt{a^2 - x^2} dx$ ($a > 0$)。

**解：**

设 $x = a\sin t$，$-\frac{\pi}{2} \leq t \leq \frac{\pi}{2}$，则 $\sqrt{a^2 - x^2} = a\cos t$, $dx = a\cos t dt$。

$$\int \sqrt{a^2 - x^2} dx = \int a\cos t \cdot a\cos t dt = a^2 \int \cos^2 t dt = a^2 \int \frac{1+\cos 2t}{2} dt$$

$$= \frac{a^2}{2} \left( t + \frac{1}{2}\sin 2t \right) + C = \frac{a^2}{2} (t + \sin t \cos t) + C$$

将 $t = \arcsin \frac{x}{a}$ 代回，并注意到 $\sin t = \frac{x}{a}$，$\cos t = \sqrt{1 - \sin^2 t} = \frac{\sqrt{a^2 - x^2}}{a}$，得到：

$$\int \sqrt{a^2 - x^2} dx = \frac{a^2}{2} \arcsin \frac{x}{a} + \frac{1}{2} x \sqrt{a^2 - x^2} + C$$

**常用的变量代换：**

1. **三角代换：**
    *   当被积函数中含有 $\sqrt{a^2 - x^2}$ 时，可令 $x = a\sin t$ 或 $x = a\cos t$。
    *   当被积函数中含有 $\sqrt{a^2 + x^2}$ 时，可令 $x = a\tan t$。
    *   当被积函数中含有 $\sqrt{x^2 - a^2}$ 时，可令 $x = a\sec t$。

2. **根式代换：** 当被积函数中含有 $\sqrt[n]{ax+b}$ 时，可令 $t = \sqrt[n]{ax+b}$。

3. **倒代换：** 当被积函数中含有 $x^n$ ($n$ 较大) 且分母的次数较高时，可令 $t = \frac{1}{x}$。

**例 2.3.6** 求 $\int \frac{1}{x^2 \sqrt{1+x^2}} dx$。

**解：**

设 $x = \tan t$，则 $\sqrt{1+x^2} = \sec t$, $dx = \sec^2 t dt$。

$$\int \frac{1}{x^2 \sqrt{1+x^2}} dx = \int \frac{1}{\tan^2 t \sec t} \sec^2 t dt = \int \frac{\sec t}{\tan^2 t} dt = \int \frac{\cos t}{\sin^2 t} dt$$

$$= -\frac{1}{\sin t} + C = -\frac{\sqrt{1+x^2}}{x} + C$$

**例 2.3.7** 求 $\int \frac{1}{x^4 \sqrt{1+x^2}} dx$

**解：**
令 $x = \frac{1}{t}$, 则 $dx = -\frac{1}{t^2}dt$
$$\int \frac{1}{x^4 \sqrt{1+x^2}} dx = \int \frac{1}{\frac{1}{t^4}\sqrt{1+\frac{1}{t^2}}}(-\frac{1}{t^2})dt = -\int \frac{t^3}{\sqrt{t^2+1}}dt$$
再令 $u = \sqrt{t^2+1}$， 则 $t^2 = u^2 - 1, tdt = udu$
$$-\int \frac{t^3}{\sqrt{t^2+1}}dt = -\int \frac{t^2}{\sqrt{t^2+1}}tdt = -\int \frac{u^2-1}{u}udu = -\int (u - \frac{1}{u})du$$
$$ = -(\frac{1}{2}u^2 - \ln|u|) + C = -\frac{1}{2}(t^2+1) + \ln|\sqrt{t^2+1}| + C$$
将 $t = \frac{1}{x}$ 代回
$$ = -\frac{1}{2}(\frac{1}{x^2} + 1) + \frac{1}{2}\ln|\frac{1}{x^2} + 1| + C$$

#### 2.3.3 总结

*   **第一类换元法 (凑微分法)：** 主要针对被积表达式中可以凑成某个函数微分的情况。
*   **第二类换元法 (变量代换法)：** 主要针对被积表达式中含有根式、三角函数等可以通过变量代换化简的情况。

换元积分法是积分学中非常重要的技巧，需要通过大量的练习才能熟练掌握。 在选择换元方法时，需要仔细观察被积函数的特点，选择合适的换元方法，才能使积分得到化简。

---

### 2.4 习题

1. 使用第一类换元法 (凑微分法) 求下列不定积分：
    *   (a) $\int \cos(3x) dx$
    *   (b) $\int xe^{-x^2} dx$
    *   (c) $\int \frac{1}{2x+1} dx$
    *   (d) $\int \frac{\ln x}{x} dx$
    *   (e) $\int \frac{e^x}{1+e^x} dx$

2. 使用第二类换元法 (变量代换法) 求下列不定积分：
    *   (a) $\int \frac{1}{\sqrt{4-x^2}} dx$
    *   (b) $\int \frac{1}{x\sqrt{x^2-1}} dx$
    *   (c) $\int \sqrt{1+\sqrt{x}} dx$
    *   (d) $\int \frac{1}{x^2+2x+5} dx$ (提示：配方)

3. 综合运用换元法求下列不定积分：
    *   (a) $\int \sin^3 x \cos x dx$
    *   (b) $\int \frac{1}{e^x + e^{-x}} dx$
    *   (c) $\int \frac{1}{\sqrt{x}(1+x)} dx$

---

以上是**第二章 不定积分与换元积分法** 的内容，重点介绍了不定积分的概念、基本积分表以及两种重要的换元积分法。 接下来的章节，我们将学习 **分部积分法与有理函数积分**。
