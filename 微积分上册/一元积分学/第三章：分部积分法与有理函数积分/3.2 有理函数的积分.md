### 3.2 有理函数的积分

**有理函数**是指可以表示成两个多项式之比的函数，即形如 $\frac{P(x)}{Q(x)}$ 的函数，其中 $P(x)$ 和 $Q(x)$ 都是多项式。

有理函数的积分在微积分中占有重要的地位，因为许多其他类型的函数可以通过变量代换转化为有理函数的积分。

#### 3.2.1 有理函数的分解

有理函数可以分为**真分式**和**假分式**两种：

*   如果 $P(x)$ 的次数小于 $Q(x)$ 的次数，则称 $\frac{P(x)}{Q(x)}$ 为**真分式**。
*   如果 $P(x)$ 的次数大于或等于 $Q(x)$ 的次数，则称 $\frac{P(x)}{Q(x)}$ 为**假分式**。

对于假分式，我们可以通过多项式除法将其化为一个多项式和一个真分式之和。 由于多项式的积分比较容易计算，因此我们主要讨论真分式的积分。

**例如：** $\frac{x}{x^2+1}$ 是真分式，而 $\frac{x^3}{x^2+1}$ 是假分式。 我们可以将后者化为：

$$\frac{x^3}{x^2+1} = x - \frac{x}{x^2+1}$$

其中 $x$ 是多项式，$\frac{x}{x^2+1}$ 是真分式。

**定理：** 任何一个真分式 $\frac{P(x)}{Q(x)}$ 都可以分解成若干个**部分分式**之和，其中每个部分分式的分母是 $Q(x)$ 的因式的一次幂或二次幂。

**分解规则：**

1. **因式分解：** 将分母 $Q(x)$ 分解成若干个不可约因式的乘积。
2. **部分分式：**
    *   如果 $Q(x)$ 包含因式 $(x-a)^k$，那么分解式中包含 $k$ 个部分分式：

        $$\frac{A_1}{x-a} + \frac{A_2}{(x-a)^2} + ... + \frac{A_k}{(x-a)^k}$$

    *   如果 $Q(x)$ 包含因式 $(x^2 + px + q)^k$ (其中 $p^2 - 4q < 0$)，那么分解式中包含 $k$ 个部分分式：

        $$\frac{B_1x + C_1}{x^2 + px + q} + \frac{B_2x + C_2}{(x^2 + px + q)^2} + ... + \frac{B_kx + C_k}{(x^2 + px + q)^k}$$

    其中 $A_i, B_i, C_i$ 都是待定常数。

**例 3.2.1** 将 $\frac{x^2 + 1}{(x-1)(x+2)(x-3)}$ 分解成部分分式。

**解：**

由于分母已经分解成三个一次因式的乘积，所以我们可以设：

$$\frac{x^2 + 1}{(x-1)(x+2)(x-3)} = \frac{A}{x-1} + \frac{B}{x+2} + \frac{C}{x-3}$$

通分并比较分子，得到：

$$x^2 + 1 = A(x+2)(x-3) + B(x-1)(x-3) + C(x-1)(x+2)$$

令 $x = 1$, $x = -2$, $x = 3$，分别得到：

$$2 = -6A, \quad 5 = 15B, \quad 10 = 10C$$

解得 $A = -\frac{1}{3}$, $B = \frac{1}{3}$, $C = 1$。

因此：

$$\frac{x^2 + 1}{(x-1)(x+2)(x-3)} = -\frac{1}{3(x-1)} + \frac{1}{3(x+2)} + \frac{1}{x-3}$$

**例 3.2.2** 将 $\frac{x}{(x-1)(x^2+1)}$ 分解成部分分式。

**解：**

由于分母包含一个一次因式 $x-1$ 和一个二次不可约因式 $x^2 + 1$，所以我们可以设：

$$\frac{x}{(x-1)(x^2+1)} = \frac{A}{x-1} + \frac{Bx+C}{x^2+1}$$

通分并比较分子，得到：

$$x = A(x^2+1) + (Bx+C)(x-1)$$

令 $x = 1$，得到 $1 = 2A$，解得 $A = \frac{1}{2}$。

比较 $x^2$ 的系数和常数项，得到：

$$0 = A + B, \quad 0 = A - C$$

解得 $B = -\frac{1}{2}$, $C = \frac{1}{2}$。

因此：

$$\frac{x}{(x-1)(x^2+1)} = \frac{1}{2(x-1)} - \frac{x-1}{2(x^2+1)}$$

**例 3.2.3** 将 $\frac{1}{x^2(x-1)}$ 分解成部分分式。

**解：**

由于分母包含一个二重因式 $x^2$ 和一个一次因式 $x-1$，所以我们可以设：

$$\frac{1}{x^2(x-1)} = \frac{A}{x} + \frac{B}{x^2} + \frac{C}{x-1}$$

通分并比较分子，得到：

$$1 = Ax(x-1) + B(x-1) + Cx^2$$

令 $x = 0$，得到 $1 = -B$，解得 $B = -1$。

令 $x = 1$，得到 $1 = C$，解得 $C = 1$。

比较 $x^2$ 的系数，得到 $0 = A + C$，解得 $A = -1$。

因此：

$$\frac{1}{x^2(x-1)} = -\frac{1}{x} - \frac{1}{x^2} + \frac{1}{x-1}$$

#### 3.2.2 部分分式的积分

将有理函数分解成部分分式后，我们就可以分别对每个部分分式进行积分。

以下是一些常见的部分分式的积分公式：

*   $\int \frac{1}{x-a} dx = \ln |x-a| + C$
*   $\int \frac{1}{(x-a)^k} dx = \frac{1}{1-k} (x-a)^{1-k} + C$ ($k \neq 1$)
*   $\int \frac{x}{x^2+px+q} dx = \frac{1}{2} \ln (x^2+px+q) - \frac{p}{2} \int \frac{1}{x^2+px+q} dx$ (通过配方可以化为 $\int \frac{1}{u^2+a^2} du$ 或 $\int \frac{1}{u^2-a^2} du$ 的形式)
*   $\int \frac{1}{x^2+px+q} dx$ 可以通过配方化为 $\int \frac{1}{u^2+a^2} du$ 或 $\int \frac{1}{u^2-a^2} du$ 的形式，然后利用基本积分表中的公式求解。
*   $\int \frac{1}{(x^2+px+q)^k} dx$ 的积分比较复杂，通常需要使用递推公式或者数值方法求解。

**例 3.2.4** 求 $\int \frac{x^2 + 1}{(x-1)(x+2)(x-3)} dx$。

**解：**

利用例 3.2.1 的结果，我们有：

$$\int \frac{x^2 + 1}{(x-1)(x+2)(x-3)} dx = \int \left( -\frac{1}{3(x-1)} + \frac{1}{3(x+2)} + \frac{1}{x-3} \right) dx$$

$$= -\frac{1}{3} \int \frac{1}{x-1} dx + \frac{1}{3} \int \frac{1}{x+2} dx + \int \frac{1}{x-3} dx$$

$$= -\frac{1}{3} \ln|x-1| + \frac{1}{3} \ln|x+2| + \ln|x-3| + C$$

**例 3.2.5** 求 $\int \frac{x}{(x-1)(x^2+1)} dx$。

**解：**

利用例 3.2.2 的结果，我们有：

$$\int \frac{x}{(x-1)(x^2+1)} dx = \int \left( \frac{1}{2(x-1)} - \frac{x-1}{2(x^2+1)} \right) dx$$

$$= \frac{1}{2} \int \frac{1}{x-1} dx - \frac{1}{2} \int \frac{x}{x^2+1} dx + \frac{1}{2} \int \frac{1}{x^2+1} dx$$

$$= \frac{1}{2} \ln|x-1| - \frac{1}{4} \ln(x^2+1) + \frac{1}{2} \arctan x + C$$

#### 3.2.3 总结

有理函数的积分可以通过以下步骤求解：

1. **化简：** 如果是有理假分式，先通过多项式除法将其化为多项式和真分式之和。
2. **分解：** 将真分式的分母分解成不可约因式的乘积，然后将真分式分解成部分分式之和。
3. **积分：** 对每个部分分式进行积分。
4. **合并：** 将各个部分分式的积分结果合并，得到最终结果。
