
### 1.5 微积分基本定理 (牛顿-莱布尼茨公式)

在前面的几节中，我们学习了定积分的概念和性质，但我们还没有解决一个关键的问题：**如何计算定积分？**

虽然定积分的定义本身提供了一种计算定积分的方法，即通过 “分割、近似、求和、取极限” 四步来计算，但这种方法在实际应用中往往非常繁琐，甚至难以执行。

幸运的是，微积分基本定理 (也称为牛顿-莱布尼茨公式) 为我们提供了一种简便而有效的方法来计算定积分。 它揭示了定积分与不定积分 (原函数) 之间的密切联系，从而将定积分的计算转化为寻找原函数的问题。

#### 1.5.1 变上限积分函数及其导数

为了引入微积分基本定理，我们首先需要定义一个重要的概念：**变上限积分函数**。

设函数 $f(x)$ 在区间 $[a, b]$ 上可积，对于任意 $x \in [a, b]$，定积分 $\int_a^x f(t) dt$ 都存在。 由于积分值随着上限 $x$ 的变化而变化，因此我们可以定义一个新的函数：

$$\Phi(x) = \int_a^x f(t) dt, \quad x \in [a, b]$$

这个函数 $\Phi(x)$ 称为 $f(x)$ 的**变上限积分函数**。

---

**直观解释：**  变上限积分函数 $\Phi(x)$ 可以理解为从 $a$ 开始，到 $x$ 结束的这段区间上，$f(t)$ 所对应的曲边梯形的面积 (考虑代数和)。 当 $x$ 变化时，曲边梯形的面积也随之变化，从而形成了一个新的函数。

---

**例 1.5.1**  设 $f(t) = t$，则 $\Phi(x) = \int_0^x t dt$ 表示从 0 到 $x$ 的这段区间上，$y=t$ 下方的三角形面积。 我们可以很容易地计算出 $\Phi(x) = \frac{1}{2}x^2$。

---

**变上限积分函数的一个重要性质是：它的导数等于被积函数。**

**定理：** 如果函数 $f(x)$ 在区间 $[a, b]$ 上连续，那么它的变上限积分函数 $\Phi(x) = \int_a^x f(t) dt$ 在 $[a, b]$ 上可导，且：

$$\Phi'(x) = \frac{d}{dx} \left( \int_a^x f(t) dt \right) = f(x)$$

**证明思路：**

我们利用导数的定义来证明。 给 $x$ 一个增量 $\Delta x$，则 $\Phi(x)$ 的增量为：

$$\Delta \Phi = \Phi(x + \Delta x) - \Phi(x) = \int_a^{x+\Delta x} f(t) dt - \int_a^x f(t) dt = \int_x^{x+\Delta x} f(t) dt$$

根据积分中值定理，存在 $\xi$ 介于 $x$ 和 $x + \Delta x$ 之间，使得：

$$\int_x^{x+\Delta x} f(t) dt = f(\xi) \Delta x$$

因此：

$$\frac{\Delta \Phi}{\Delta x} = f(\xi)$$

当 $\Delta x \to 0$ 时，$\xi \to x$。 由于 $f(x)$ 在 $x$ 处连续，所以 $f(\xi) \to f(x)$。 因此：

$$\Phi'(x) = \lim_{\Delta x \to 0} \frac{\Delta \Phi}{\Delta x} = \lim_{\Delta x \to 0} f(\xi) = f(x)$$

**解释：** 这个定理表明，变上限积分函数的导数等于被积函数本身。 这就好比，如果你知道了一个物体运动的速度 $v(t)$，那么你在某一时刻 $t$ 累积的路程对时间的导数，就是该时刻的瞬时速度 $v(t)$。

---

#### 1.5.2 牛顿-莱布尼茨公式的推导与应用

现在，我们利用变上限积分函数的导数性质来推导微积分基本定理。

**定理 (牛顿-莱布尼茨公式)：** 如果函数 $F(x)$ 是连续函数 $f(x)$ 在区间 $[a, b]$ 上的一个原函数，那么：

$$\int_a^b f(x) dx = F(b) - F(a)$$

**证明：**

设 $\Phi(x) = \int_a^x f(t) dt$。 根据前面的定理，我们知道 $\Phi'(x) = f(x)$。 这说明 $\Phi(x)$ 也是 $f(x)$ 的一个原函数。

由于 $F(x)$ 和 $\Phi(x)$ 都是 $f(x)$ 的原函数，所以它们之间只相差一个常数，即：

$$\Phi(x) = F(x) + C$$

令 $x = a$，则 $\Phi(a) = \int_a^a f(t) dt = 0$。 因此：

$$0 = F(a) + C \Rightarrow C = -F(a)$$

所以：

$$\Phi(x) = F(x) - F(a)$$

令 $x = b$，则 $\Phi(b) = \int_a^b f(t) dt$。 因此：

$$\int_a^b f(t) dt = F(b) - F(a)$$

将积分变量 $t$ 换成 $x$，即得到牛顿-莱布尼茨公式：

$$\int_a^b f(x) dx = F(b) - F(a)$$

**数学公式 (LaTeX):**

```latex
\int_a^b f(x) dx = F(b) - F(a)
```

**解释：** 牛顿-莱布尼茨公式建立了定积分和原函数之间的联系。 它告诉我们，要计算一个连续函数 $f(x)$ 在区间 $[a, b]$ 上的定积分，只需要找到它的一个原函数 $F(x)$，然后计算原函数在区间端点的值的差 $F(b) - F(a)$ 即可。

**常用记号：**  我们通常将 $F(b) - F(a)$ 记作 $F(x) \Big|_a^b$，即：

$$F(x) \Big|_a^b = F(b) - F(a)$$

因此，牛顿-莱布尼茨公式也可以写成：

$$\int_a^b f(x) dx = F(x) \Big|_a^b$$

---

**例 1.5.2** 计算 $\int_0^1 x^2 dx$。

**解：** 因为 $F(x) = \frac{1}{3}x^3$ 是 $f(x) = x^2$ 的一个原函数，所以根据牛顿-莱布尼茨公式：

$$\int_0^1 x^2 dx = \frac{1}{3}x^3 \Big|_0^1 = \frac{1}{3}(1)^3 - \frac{1}{3}(0)^3 = \frac{1}{3}$$

---

**例 1.5.3** 计算 $\int_1^2 \frac{1}{x} dx$。

**解：** 因为 $F(x) = \ln x$ 是 $f(x) = \frac{1}{x}$ 的一个原函数，所以根据牛顿-莱布尼茨公式：

$$\int_1^2 \frac{1}{x} dx = \ln x \Big|_1^2 = \ln 2 - \ln 1 = \ln 2$$

---

**总结：** 牛顿-莱布尼茨公式是微积分学中的核心定理之一，它将定积分的计算问题转化为了求原函数的问题，极大地简化了定积分的计算。

---

#### 1.5.3  习题

1. 计算下列定积分：
    *   (a) $\int_0^{\pi/2} \sin x dx$
    *   (b) $\int_1^e \frac{1}{x} dx$
    *   (c) $\int_0^1 (x^3 + 2x - 1) dx$
    *   (d) $\int_{-1}^1 e^x dx$

2. 已知 $F(x) = \int_0^x \sin t^2 dt$，求 $F'(x)$。

3. 证明：如果 $f(x)$ 是 $[a, b]$ 上的奇函数，那么 $\int_{-a}^a f(x) dx = 0$；如果 $f(x)$ 是 $[a, b]$ 上的偶函数，那么 $\int_{-a}^a f(x) dx = 2\int_0^a f(x) dx$。
