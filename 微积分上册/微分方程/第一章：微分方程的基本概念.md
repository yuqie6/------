### 1.1  什么是微分方程？

**1.1.1 引言**

在科学和工程的各个领域，我们经常需要描述各种现象的变化规律。例如，物体运动的速度、温度的变化、种群数量的增长、电路中电流的变化等等。这些变化规律往往可以用包含未知函数及其导数的方程来表示，这种方程就叫做**微分方程**。

**1.1.2 微分方程的定义**

一个**微分方程**是一个包含未知函数及其导数（或微分）的关系式。更准确地说，设 $y=f(x)$ 是一个未知函数，一个包含 $x$, $y$, $y'$, $y''$, ..., $y^{(n)}$ 的方程

$$F(x, y, y', y'', ..., y^{(n)}) = 0$$

称为**微分方程**，其中 $y^{(n)}$ 表示 $y$ 关于 $x$ 的 $n$ 阶导数。

**1.1.3 例子**

以下是一些微分方程的例子：

*   $y' = 2x$  (描述了斜率为自变量两倍的函数)
*   $y'' + y = 0$  (描述了简谐振动)
*   $y' = ky$  (描述了指数增长或衰减)
*   $\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}$ (热传导方程，其中 $u(x,t)$ 表示温度)
*   $\frac{\partial^2 u}{\partial t^2} = c^2 \frac{\partial^2 u}{\partial x^2}$ (波动方程，其中 $u(x,t)$ 表示位移)

**1.1.4 微分方程的阶**

微分方程中出现的未知函数的最高阶导数的阶数称为微分方程的**阶**。

例如：

*   $y' = 2x$ 是一阶微分方程。
*   $y'' + y = 0$ 是二阶微分方程。
*   $y''' - 3y'' + 3y' - y = 0$ 是三阶微分方程。
*   $\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}$ 关于 $u(x,t)$ 是二阶微分方程 (因为最高阶导数是二阶偏导数)。

**1.1.5 微分方程的解**

一个函数 $y = \phi(x)$ 称为微分方程 $F(x, y, y', y'', ..., y^{(n)}) = 0$ 在区间 $I$ 上的一个**解**，如果 $\phi(x)$ 在区间 $I$ 上具有 $n$ 阶连续导数，且将 $y = \phi(x)$, $y' = \phi'(x)$, ..., $y^{(n)} = \phi^{(n)}(x)$ 代入微分方程后，方程在区间 $I$ 上恒成立。

**例 1.1.1**  验证函数 $y = e^x$ 是微分方程 $y' - y = 0$ 的一个解。

**解：** 因为 $y = e^x$, 所以 $y' = e^x$。将 $y$ 和 $y'$ 代入方程 $y' - y = 0$，得到 $e^x - e^x = 0$，该式恒成立。因此，$y = e^x$ 是微分方程 $y' - y = 0$ 的一个解。

**例 1.1.2**  验证函数 $y = C_1 \cos x + C_2 \sin x$ (其中 $C_1$ 和 $C_2$ 是任意常数) 是微分方程 $y'' + y = 0$ 的一个解。

**解：** 因为 $y = C_1 \cos x + C_2 \sin x$, 所以 $y' = -C_1 \sin x + C_2 \cos x$, $y'' = -C_1 \cos x - C_2 \sin x$。将 $y$ 和 $y''$ 代入方程 $y'' + y = 0$，得到 $(-C_1 \cos x - C_2 \sin x) + (C_1 \cos x + C_2 \sin x) = 0$，该式恒成立。因此，$y = C_1 \cos x + C_2 \sin x$ 是微分方程 $y'' + y = 0$ 的一个解。

**1.1.6 通解和特解**

*   **通解：** 如果微分方程的解中包含任意常数，且任意常数的个数与微分方程的阶数相同，这样的解称为微分方程的**通解**。
*   **特解：** 通过确定通解中的任意常数而得到的具体解称为微分方程的**特解**。

在例 1.1.2 中，$y = C_1 \cos x + C_2 \sin x$ 是微分方程 $y'' + y = 0$ 的通解。如果我们给定条件 $C_1 = 1$，$C_2 = 0$，则得到特解 $y = \cos x$。

**1.1.7 初值条件和初值问题**

确定通解中任意常数的条件称为**定解条件**。对于一阶微分方程，通常需要一个定解条件来确定通解中的一个任意常数。对于 $n$ 阶微分方程，通常需要 $n$ 个定解条件来确定通解中的 $n$ 个任意常数。

在微分方程中，用来确定任意常数的条件，如果给定的都是在某一点 $x_0$ 处的函数值和导数值，则这些条件称为**初值条件**。例如：

$$y(x_0) = y_0, \quad y'(x_0) = y_1, \quad ..., \quad y^{(n-1)}(x_0) = y_{n-1}$$

微分方程和初值条件一起构成的问题称为**初值问题**。

**例 1.1.3** 求微分方程 $y' = 2x$ 满足初值条件 $y(1) = 2$ 的特解。

**解：** 对 $y' = 2x$ 两边积分，得到 $y = x^2 + C$，这是微分方程的通解。将初值条件 $y(1) = 2$ 代入通解，得到 $2 = 1^2 + C$，解得 $C = 1$。因此，满足初值条件的特解为 $y = x^2 + 1$。

### 1.2  微分方程的分类

除了按**阶数**分类，微分方程还可以按以下方式分类：

**1.2.1 线性与非线性微分方程**

如果微分方程 $F(x, y, y', ..., y^{(n)}) = 0$ 关于未知函数 $y$ 及其各阶导数都是一次的，则称之为**线性微分方程**，否则称之为**非线性微分方程**。

线性微分方程的一般形式可以写成：

$$a_n(x)y^{(n)} + a_{n-1}(x)y^{(n-1)} + ... + a_1(x)y' + a_0(x)y = f(x)$$

其中 $a_n(x), a_{n-1}(x), ..., a_1(x), a_0(x)$ 和 $f(x)$ 都是 $x$ 的函数。

*   如果 $f(x) = 0$，则称该方程为**齐次线性微分方程**。
*   如果 $f(x) \neq 0$，则称该方程为**非齐次线性微分方程**。

**例 1.2.1** 以下是一些线性微分方程的例子：

*   $y' - 2xy = x^2$ (一阶非齐次线性微分方程)
*   $y'' + 4y' + 4y = 0$ (二阶齐次线性微分方程)
*   $x^2 y''' - xy' + y = \sin x$ (三阶非齐次线性微分方程)

**例 1.2.2** 以下是一些非线性微分方程的例子：

*   $y' = y^2$ (因为 $y$ 的次数是 2)
*   $y'' + \sin y = 0$ (因为出现了 $\sin y$)
*   $yy' = x$ (因为 $y$ 和 $y'$ 相乘)

**1.2.2 常微分方程与偏微分方程**

*   **常微分方程 (ODE)：** 未知函数只包含一个自变量的微分方程称为**常微分方程**。
*   **偏微分方程 (PDE)：** 未知函数包含两个或两个以上自变量的微分方程称为**偏微分方程**。

前面举的例子中，除了热传导方程和波动方程是偏微分方程外，其余都是常微分方程。

### 1.3 微分方程模型

微分方程是描述各种自然现象和社会现象中变量之间变化规律的有力工具。建立微分方程模型的一般步骤如下：

1. **根据实际问题提出合理的假设。**
2. **利用已知规律（如物理定律、化学定律、生物学规律等）建立变量之间的关系式。**
3. **将关系式转化为包含未知函数及其导数的方程，即微分方程。**
4. **确定定解条件（如初值条件或边界条件）。**
5. **求解微分方程（或进行数值计算、定性分析等）。**
6. **对结果进行解释和检验，并根据实际情况修正模型。**

**例 1.3.1 (人口模型)**  假设人口增长率与人口数量成正比，建立人口数量 $P(t)$ 随时间 $t$ 变化的微分方程模型。

**解：** 设 $P(t)$ 表示 $t$ 时刻的人口数量，根据假设，人口增长率 $\frac{dP}{dt}$ 与 $P(t)$ 成正比，即

$$\frac{dP}{dt} = rP$$

其中 $r$ 是比例常数，称为人口增长率。如果我们还知道初始时刻 $t=0$ 的人口数量为 $P_0$，即 $P(0) = P_0$，那么我们就得到了一个完整的微分方程模型：

$$\begin{cases}
\frac{dP}{dt} = rP \\
P(0) = P_0
\end{cases}$$

这个模型描述了人口指数增长的规律。

**例 1.3.2 (牛顿冷却定律)**  一个物体的温度变化率与物体和周围环境的温度差成正比。设物体的温度为 $T(t)$，周围环境的温度为 $T_a$，建立物体温度变化的微分方程模型。

**解：** 根据牛顿冷却定律，物体温度变化率 $\frac{dT}{dt}$ 与 $T - T_a$ 成正比，即

$$\frac{dT}{dt} = -k(T - T_a)$$

其中 $k$ 是正的比例常数。负号表示当物体温度高于环境温度时，物体温度下降。如果已知初始时刻 $t=0$ 物体的温度为 $T_0$，即 $T(0) = T_0$，那么我们就得到了一个完整的微分方程模型：

$$\begin{cases}
\frac{dT}{dt} = -k(T - T_a) \\
T(0) = T_0
\end{cases}$$

### 1.3 微分方程模型 (补充)

**(续前文)** 微分方程是描述各种自然现象和社会现象中变量之间变化规律的有力工具。下面我们再举几个微分方程在不同领域应用的例子。

**例 1.3.3 (RLC 电路)**  在一个包含电阻 (R)、电感 (L) 和电容 (C) 的串联电路中，电流 $i(t)$ 随时间 $t$ 的变化规律可以用一个二阶线性微分方程来描述。根据基尔霍夫定律，电路中的电压降之和等于电动势，我们可以得到：

$$L\frac{di}{dt} + Ri + \frac{1}{C}\int i dt = E(t)$$

其中 $E(t)$ 是外部电源的电动势。对上式两边求导，得到关于电流 $i(t)$ 的二阶微分方程：

$$L\frac{d^2i}{dt^2} + R\frac{di}{dt} + \frac{1}{C}i = \frac{dE(t)}{dt}$$

如果我们还知道初始时刻的电流 $i(0)$ 和电容器上的初始电荷 $q(0)$ (由于 $q(t) = \int i(t) dt$，因此也相当于知道了初始时刻 $i'(0)$ 的值)，就可以确定该微分方程的特解，从而得到电路中电流随时间变化的规律。

**例 1.3.4 (传染病模型)**  微分方程也被广泛应用于传染病的建模和预测。一个简单的传染病模型 (SI 模型) 将人群分为易感者 (Susceptible) 和感染者 (Infected) 两类。设 $S(t)$ 和 $I(t)$ 分别表示 $t$ 时刻易感者和感染者在总人数中所占的比例，假设感染者比例的增长率与易感者和感染者的接触机会成正比，我们可以建立如下的微分方程模型：

$$\frac{dI}{dt} = \beta SI$$

其中 $\beta$ 是传染系数。由于 $S(t) + I(t) = 1$，因此我们可以将模型简化为：

$$\frac{dI}{dt} = \beta (1-I)I$$

如果我们还知道初始时刻感染者的比例 $I(0)$，就可以求解该微分方程，从而预测传染病的发展趋势。更复杂的传染病模型还会考虑潜伏期、隔离、康复等因素，例如 SIR 模型、SEIR 模型等。

**例 1.3.5 (捕食者-猎物模型)**  微分方程还可以用来描述生态系统中不同物种之间的相互作用。例如，一个简单的捕食者-猎物模型 (Lotka-Volterra 模型) 可以用如下的微分方程组来表示：

$$\begin{cases}
\frac{dx}{dt} = ax - bxy \\
\frac{dy}{dt} = -cy + dxy
\end{cases}$$

其中 $x(t)$ 表示猎物的数量，$y(t)$ 表示捕食者的数量，$a, b, c, d$ 都是正的常数。第一个方程表示猎物的增长率与自身数量成正比，但会受到捕食者数量的负面影响；第二个方程表示捕食者的增长率与猎物数量成正比，但会受到自身数量的负面影响 (由于资源有限)。通过分析这个微分方程组，我们可以研究捕食者和猎物数量之间的动态平衡关系。

### 1.4 微分方程解的几何意义 (新增)

**1.4.1 方向场**

对于一阶微分方程 $y' = f(x,y)$，它在平面上的每一点 $(x,y)$ 都确定了一个斜率 $f(x,y)$。我们可以在平面上画出许多短线段，每个短线段的斜率等于该点处 $f(x,y)$ 的值，这些短线段就构成了微分方程的**方向场**。

方向场可以帮助我们直观地了解微分方程的解的趋势。例如，如果方向场中某一点附近的短线段都指向某个方向，那么该方向就可能是解曲线的延伸方向。

**1.4.2 积分曲线**

微分方程的解 $y = \phi(x)$ 在几何上表示一条曲线，称为微分方程的**积分曲线**。积分曲线上的每一点的切线斜率都等于微分方程在该点确定的斜率，也就是说，积分曲线与方向场相切。

通过观察方向场，我们可以大致描绘出积分曲线的形状，从而对微分方程的解有一个直观的认识。

**例 1.4.1**  考虑微分方程 $y' = x$。

它的方向场如右图所示。我们可以看出，积分曲线应该是一族抛物线。实际上，该方程的通解为 $y = \frac{1}{2}x^2 + C$，确实是一族抛物线。

[Image of Direction field for y' = x] (你可以使用一些数学软件，例如 GeoGebra, Maple, MATLAB 等来绘制方向场)

**1.4.3 奇解**

有些微分方程可能存在一些特殊的解，它们不能通过通解中的任意常数来确定，这些解称为**奇解**。奇解通常是积分曲线族的包络线。

**例 1.4.2** 微分方程 $y' = 2\sqrt{y}$ 的通解为 $y = (x+C)^2$。但 $y=0$ 也是这个方程的解，却不能包含在通解中。从几何上看，$y=0$ 是积分曲线族 $y=(x+C)^2$ 的包络线。

---

### 1.5 习题

1. 指出下列微分方程的阶数，并判断它们是线性还是非线性，如果是线性的，指出它是齐次的还是非齐次的：
    *   (a) $y'' + 2xy' - y^3 = e^x$
    *   (b) $y^{(4)} + \cos(x)y'' + y = 0$
    *   (c) $y' = \sqrt{1 + y^2}$
    *   (d) $\frac{d^2x}{dt^2} + \omega^2 x = f(t)$
    *   (e) $y''y - xy' = 0$

2. 验证给定的函数是否是相应微分方程的解：
    *   (a) $y' - 3y = 0$; $y = Ce^{3x}$
    *   (b) $y'' + 9y = 0$; $y = C_1 \cos 3x + C_2 \sin 3x$
    *   (c) $y' = 2xy^2$; $y = -\frac{1}{x^2 + C}$

3. 求下列微分方程满足给定初值条件的特解：
    *   (a) $y' = e^{-x}$; $y(0) = 1$
    *   (b) $y'' + 4y = 0$; $y(0) = 1$, $y'(0) = 0$

4. 一个弹簧-质量系统中，质量为 $m$ 的物体在弹簧的作用下做简谐振动。设位移为 $x(t)$，弹簧的劲度系数为 $k$，根据牛顿第二定律建立该系统的微分方程模型。

5. 某种放射性物质的衰变速率与该物质的质量成正比。设该物质的质量为 $m(t)$，建立该物质质量变化的微分方程模型