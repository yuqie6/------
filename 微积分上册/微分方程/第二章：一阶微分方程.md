
## 第二章：一阶微分方程

### 2.1 可分离变量的微分方程

**2.1.1 定义**

一阶微分方程描述的是函数及其一阶导数之间的关系，在众多一阶微分方程中，有一类特殊且易于求解的方程，被称为**可分离变量的微分方程**。这类方程的特点在于，通过代数操作，可以将方程中的自变量 $x$ 和因变量 $y$ 分别置于等式的两侧，从而实现变量的分离。更具体地说，如果一个一阶微分方程能够被转化为如下形式之一：

$$g(y) \frac{dy}{dx} = f(x)$$

或者

$$\frac{dy}{dx} = \frac{f(x)}{g(y)}$$

则我们称该方程为**可分离变量的微分方程**。这里的关键在于，$f(x)$ 必须是只包含自变量 $x$ 的函数，而 $g(y)$ 必须是只包含因变量 $y$ 的函数，它们之间不能存在交叉项，这确保了变量分离的可行性。

**2.1.2 解法**

可分离变量的微分方程之所以容易求解，正是因为其变量可以分离的特性。其解法通常遵循以下步骤：

1.  **分离变量：** 这是解题的关键步骤，其目的是将含有 $y$ 的项和含有 $x$ 的项分别置于等式的两侧。具体操作是，将原方程改写为以下形式：

    $$g(y)dy = f(x)dx$$

    这一步的本质是将微分方程转化为一个关于 $y$ 和 $x$ 的等式，等式左侧只包含 $y$ 的函数和微分 $dy$，右侧只包含 $x$ 的函数和微分 $dx$。

2.  **两边积分：** 完成变量分离后，对等式两边同时进行不定积分运算。由于不定积分会产生一个任意常数，通常将其记为 $C$，则得到：

    $$\int g(y) dy = \int f(x) dx + C$$

    这里，$C$ 代表任意常数，确保了我们能够获得微分方程的通解，即包含所有可能解的形式。

3.  **求解积分：** 计算出上述两个不定积分，这意味着我们需要找到函数 $g(y)$ 和 $f(x)$ 的原函数。经过积分运算，我们最终得到一个包含 $x$，$y$ 和任意常数 $C$ 的隐式方程，它代表了微分方程的解，但此时 $y$ 通常没有以 $x$ 的显式函数表示。

4.  **求显式解 (如果可能)：** 理想情况下，我们希望将上述隐式方程转化为 $y$ 关于 $x$ 的显式函数形式，即 $y = \phi(x, C)$。但这并非总是可行，因为有些隐式方程可能难以转化为显式形式。在能够转化为显式形式的情况下，我们就可以得到更直观的函数关系，方便我们分析和应用。

**例 2.1.1**  求解微分方程 $\frac{dy}{dx} = \frac{x}{y}$。

**解：**

1.  **分离变量：** 首先，将原方程进行变量分离，将 $y$ 移到等式左侧，将 $dx$ 移到等式右侧，得到：

    $$ydy = xdx$$

2.  **两边积分：** 对等式两边同时进行不定积分，并加上任意常数 $C$，得到：

    $$\int y dy = \int x dx + C$$

3.  **求解积分：**  对两边进行积分运算，得到：

    $$\frac{1}{2}y^2 = \frac{1}{2}x^2 + C$$

4.  **求显式解：** 为了得到 $y$ 关于 $x$ 的显式表达，我们将等式两边乘以 2，得到：

    $$y^2 = x^2 + 2C$$

    为了方便，我们可以将 $2C$ 记作一个新的常数 $C_1$，则通解为：

    $$y^2 = x^2 + C_1$$

   进一步，我们可以通过开平方得到显式解：

    $$y = \pm \sqrt{x^2 + C_1}$$

    这表示该微分方程的解由两个函数分支组成，一个是正平方根，一个是负平方根。

**例 2.1.2**  求解微分方程 $\frac{dy}{dx} = e^{x-y}$。

**解：**

1.  **分离变量：**  首先，利用指数的性质 $e^{x-y} = e^x e^{-y}$，将原方程改写为：

    $$\frac{dy}{dx} = e^x e^{-y}$$

   然后，进行变量分离，得到：

    $$e^y dy = e^x dx$$

2.  **两边积分：** 对等式两边同时进行不定积分，并加上任意常数 $C$，得到：

    $$\int e^y dy = \int e^x dx + C$$

3.  **求解积分：**  对两边进行积分运算，得到：

    $$e^y = e^x + C$$

4.  **求显式解：** 为了得到 $y$ 关于 $x$ 的显式表达，对等式两边取自然对数，得到：

    $$y = \ln(e^x + C)$$

    这表示该微分方程的通解为一个包含对数和指数的函数形式。

**例 2.1.3** 求解初值问题 $\frac{dy}{dx} = \frac{2x}{y+1}$, $y(0) = 1$。

**解：**

1. **分离变量：**  将原方程进行变量分离，得到：

    $$(y+1)dy = 2xdx$$

2.  **两边积分：** 对等式两边同时进行不定积分，并加上任意常数 $C$，得到：

    $$\int (y+1) dy = \int 2x dx + C$$

3.  **求解积分：**  对两边进行积分运算，得到：

    $$\frac{1}{2}y^2 + y = x^2 + C$$

4.  **求显式解 (可选)：**  此例中，可以通过配方法得到 $y$ 的显式解，但是比较复杂，此处略去，我们保留隐式解的形式。

5.  **代入初值条件：**  为了确定特解，将初值条件 $x=0$, $y=1$ 代入隐式解，得到：

    $$\frac{1}{2}(1)^2 + 1 = 0^2 + C$$

    解得 $C = \frac{3}{2}$。

    因此，初值问题的特解为：

    $$\frac{1}{2}y^2 + y = x^2 + \frac{3}{2}$$
    
    这个解满足了微分方程和给定的初始条件，代表了该初值问题的唯一解。

**2.1.3 注意事项**

在分离变量的过程中，如果涉及到除法运算，需要特别注意分母不能为零的情况。如果分母可能为零，则需要单独讨论。这是因为，当分母为零时，方程可能无意义，或者产生特殊的解。

**例 2.1.4** 求解微分方程 $\frac{dy}{dx} = 2xy^2$。

**解：**

1.  **分离变量：** 当 $y \neq 0$ 时，可以将方程两边除以 $y^2$，得到：

    $$\frac{1}{y^2}dy = 2xdx$$
    
    这里我们强调 $y \neq 0$ ，是因为当 $y=0$时，除法运算无意义，需要单独考虑。

2.  **两边积分：** 对等式两边同时进行不定积分，并加上任意常数 $C$，得到：

    $$\int \frac{1}{y^2} dy = \int 2x dx + C$$

3.  **求解积分：** 对两边进行积分运算，得到：

    $$-\frac{1}{y} = x^2 + C$$

4.  **求显式解：** 将 $y$ 用 $x$ 表示，得到：

    $$y = -\frac{1}{x^2 + C}$$

5.  **单独讨论 $y=0$ 的情况：**  当 $y = 0$ 时，原微分方程 $\frac{dy}{dx} = 2xy^2$ 显然成立，因为此时 $\frac{dy}{dx} = 0$。因此 $y=0$ 也是原方程的一个解。这个解是方程的一个特解，或者说奇解。

    综上所述，原方程的通解为

    $$y = -\frac{1}{x^2 + C} \quad \text{或} \quad y = 0$$

    其中 $y=0$ 是一个**奇解**，它不能包含在通解中。这意味着我们不能通过改变 $C$ 的值来得到 $y=0$ 这个解。

### 2.2 习题

1. 求解下列微分方程：
    *   (a) $\frac{dy}{dx} = \frac{x+1}{y^2}$
    *   (b) $\frac{dy}{dx} = \frac{y}{x}$
    *   (c) $\frac{dy}{dx} = \frac{1+y^2}{1+x^2}$
    *   (d) $y' = \cos^2 y$
    *   (e) $e^y y' = x$

2. 求解下列初值问题：
    *   (a) $\frac{dy}{dx} = \frac{x}{y^2}$, $y(1) = 1$
    *   (b) $\frac{dy}{dx} = \frac{y}{x+1}$, $y(0) = 2$

3. 证明：如果 $y = \phi(x)$ 是微分方程 $y' = f(x)$ 的一个解，则对任意常数 $C$，$y = \phi(x) + C$ 也是该方程的解。

4. 一个质量为 $m$ 的物体从高空自由下落，假设空气阻力与速度成正比，比例系数为 $k$，求物体速度 $v(t)$ 随时间 $t$ 变化的规律 (提示：根据牛顿第二定律，物体所受合力 $F = mg - kv$，其中 $g$ 是重力加速度)。

### 2.3 一阶线性微分方程

**2.3.1 定义**

在微分方程的研究中，**一阶线性微分方程**占据着重要的地位。这类方程具有明确的结构特征和成熟的解法，能够描述许多实际问题。一个一阶微分方程，如果能够被整理成以下标准形式：

$$\frac{dy}{dx} + P(x)y = Q(x)$$

则称之为**一阶线性微分方程**。这里的 $y$ 是因变量，$x$ 是自变量。$P(x)$ 和 $Q(x)$ 都是已知的函数，且它们都只与自变量 $x$ 有关，而不能包含因变量 $y$。

*   如果 $Q(x)$ 恒等于零，即 $Q(x) \equiv 0$，那么该一阶线性微分方程就被称为**齐次线性微分方程**。此时方程的形式简化为：

    $$\frac{dy}{dx} + P(x)y = 0$$

    齐次方程的特点是，当 $y=0$ 时，方程恒成立，因此 $y=0$ 是齐次方程的一个解，我们称之为平凡解或零解。

*   如果 $Q(x)$ 不恒等于零，即 $Q(x) \not\equiv 0$，那么该一阶线性微分方程就被称为**非齐次线性微分方程**。非齐次方程的解法相对复杂，需要用到常数变易法等技巧。

**2.3.2 齐次线性微分方程的解法**

对于一阶齐次线性微分方程：

$$\frac{dy}{dx} + P(x)y = 0$$

我们可以通过分离变量法来求解。这个方法的核心思想是，将微分方程转化为一个可以直接积分的形式。将方程改写为：

$$\frac{dy}{y} = -P(x)dx$$

接下来，对等式两边同时进行不定积分，得到：

$$\int \frac{dy}{y} = -\int P(x) dx + C$$

其中，$C$ 是积分过程中产生的任意常数。通过积分计算，我们得到：

$$\ln |y| = -\int P(x) dx + C$$

为了消去对数，我们将等式两边同时取指数，得到：

$$|y| = e^{-\int P(x) dx + C} = e^C e^{-\int P(x) dx}$$

由于 $e^C$ 仍然是一个任意正数，我们可以将其记作一个新的任意常数 $C_1$，并且考虑到 $y$ 可以取正负值，我们可以写出：

$$y = \pm e^C e^{-\int P(x) dx}$$

最终，一阶齐次线性微分方程的通解可以简洁地表示为：

$$y = C_1 e^{-\int P(x) dx}$$

这个公式揭示了齐次线性微分方程解的结构：解的形式由一个任意常数 $C_1$ 和一个指数函数构成，其中指数部分是函数 $P(x)$ 的负积分。

**2.3.3 非齐次线性微分方程的解法 (常数变易法)**

对于一阶非齐次线性微分方程：

$$\frac{dy}{dx} + P(x)y = Q(x)$$

我们可以使用**常数变易法**来求解。常数变易法的核心思想是将齐次方程的通解中的常数 $C_1$ 视为一个关于 $x$ 的未知函数 $u(x)$，然后将其代入非齐次方程，求解该函数。具体步骤如下：

1.  **引入未知函数:** 首先，我们回顾齐次方程的通解：

    $$y = C_1 e^{-\int P(x) dx}$$

   我们将通解中的常数 $C_1$ 替换为一个关于 $x$ 的未知函数 $u(x)$，令：

    $$y = u(x) e^{-\int P(x) dx}$$

2.  **代入原方程：** 将上述 $y$ 的表达式代入原非齐次方程，得到：

    $$\frac{d}{dx}\left(u(x) e^{-\int P(x) dx}\right) + P(x) u(x) e^{-\int P(x) dx} = Q(x)$$

3.  **利用乘积求导法则：** 根据乘积求导法则，我们有：

    $$\frac{du}{dx} e^{-\int P(x) dx} + u(x) \frac{d}{dx}\left(e^{-\int P(x) dx}\right) + P(x) u(x) e^{-\int P(x) dx} = Q(x)$$

4.  **化简方程:** 注意到 $\frac{d}{dx}\left(e^{-\int P(x) dx}\right) = -P(x) e^{-\int P(x) dx}$，因此上式可以化简为：

    $$\frac{du}{dx} e^{-\int P(x) dx} - u(x) P(x) e^{-\int P(x) dx} + P(x) u(x) e^{-\int P(x) dx} = Q(x)$$

   化简后，我们发现中间两项相互抵消，得到：

   $$\frac{du}{dx} e^{-\int P(x) dx} = Q(x)$$

5.  **求解 du/dx :**  将等式两边乘以 $e^{\int P(x) dx}$，得到：

    $$\frac{du}{dx} = Q(x) e^{\int P(x) dx}$$

6.  **求解 u(x):** 对上式两边积分，得到：

    $$u(x) = \int Q(x) e^{\int P(x) dx} dx + C$$

    这里的 $C$ 是积分产生的任意常数。

7.  **得到通解:**  将 $u(x)$ 的表达式代回 $y = u(x) e^{-\int P(x) dx}$，得到一阶非齐次线性微分方程的通解：

    $$y = e^{-\int P(x) dx} \left( \int Q(x) e^{\int P(x) dx} dx + C \right)$$

   这个公式称为一阶线性微分方程的**通解公式**，它给出了非齐次线性方程解的一般形式，其中包含了一个积分项和一个任意常数。

**2.3.4 积分因子**

在上述推导过程中，我们实际上是将原方程乘以了一个函数 $e^{\int P(x) dx}$，这个函数被称为**积分因子**。积分因子的作用是将原方程转化为一个可以很容易地通过积分求解的形式。具体来说，当我们把一阶线性微分方程乘以积分因子时，方程的左边就会变成某个函数的导数，从而方便积分求解。

**例 2.3.1** 求解微分方程 $\frac{dy}{dx} + 2xy = x$。

**解：**

这是一个一阶非齐次线性微分方程，其中 $P(x) = 2x$, $Q(x) = x$。

1.  **计算积分因子：**  首先，计算积分因子 $e^{\int P(x) dx}$：

    $$e^{\int P(x) dx} = e^{\int 2x dx} = e^{x^2}$$

2.  **乘以积分因子：**  将原方程两边同时乘以积分因子 $e^{x^2}$，得到：

    $$e^{x^2}\frac{dy}{dx} + 2xe^{x^2}y = xe^{x^2}$$

3.  **化为导数形式：**  注意到方程左边恰好是 $(e^{x^2}y)$ 的导数，因此上式可以写成：

    $$\frac{d}{dx}(e^{x^2}y) = xe^{x^2}$$

4.  **两边积分：**  对上式两边同时积分，得到：

    $$e^{x^2}y = \int xe^{x^2} dx + C$$
    
    右边的积分可以使用换元法，令 $u=x^2$, 则$du=2xdx$，因此
    
     $$\int xe^{x^2} dx = \frac{1}{2} \int e^u du = \frac{1}{2}e^u+C_1 = \frac{1}{2}e^{x^2}+C_1$$

    所以
    $$e^{x^2}y = \frac{1}{2}e^{x^2} + C$$

5.  **得到通解：**  将等式两边同时除以 $e^{x^2}$，得到原方程的通解为：

    $$y = \frac{1}{2} + Ce^{-x^2}$$

**例 2.3.2** 求解微分方程 $x\frac{dy}{dx} - 2y = x^3$，$x>0$。

**解：**

1. **化为标准形式：**  首先，将原方程化为标准形式，即 $\frac{dy}{dx} + P(x)y = Q(x)$ 的形式。将方程两边除以 $x$，得到：

    $$\frac{dy}{dx} - \frac{2}{x}y = x^2$$
   
    这是一个一阶非齐次线性微分方程，其中 $P(x) = -\frac{2}{x}$, $Q(x) = x^2$。

2.  **计算积分因子：**  计算积分因子 $e^{\int P(x) dx}$：

    $$e^{\int P(x) dx} = e^{\int -\frac{2}{x} dx} = e^{-2\ln x} = e^{\ln x^{-2}} = x^{-2} = \frac{1}{x^2}$$

3.  **乘以积分因子：**  将原方程两边同时乘以积分因子 $\frac{1}{x^2}$，得到：

    $$\frac{1}{x^2}\frac{dy}{dx} - \frac{2}{x^3}y = 1$$

4.  **化为导数形式：**  注意到方程左边恰好是 $(\frac{1}{x^2}y)$ 的导数，因此上式可以写成：

    $$\frac{d}{dx}\left(\frac{1}{x^2}y\right) = 1$$

5.  **两边积分：**  对上式两边同时积分，得到：

    $$\frac{1}{x^2}y = \int 1 dx + C = x + C$$

6.  **得到通解：**  将等式两边同时乘以 $x^2$，得到原方程的通解为：

    $$y = x^3 + Cx^2$$

**例 2.3.3** 求解初值问题 $\frac{dy}{dx} + y = e^x$, $y(0) = 1$。

**解：**

1.  **识别方程：** 这是一个一阶非齐次线性微分方程，其中 $P(x) = 1$, $Q(x) = e^x$。

2.  **计算积分因子：**  计算积分因子 $e^{\int P(x) dx}$：

    $$e^{\int P(x) dx} = e^{\int 1 dx} = e^x$$

3.  **乘以积分因子：** 将原方程两边同时乘以积分因子 $e^x$，得到：

    $$e^x\frac{dy}{dx} + e^x y = e^{2x}$$

4.  **化为导数形式：**  方程左边恰好是 $(e^x y)$ 的导数，因此上式可以写成：

    $$ \frac{d}{dx}(e^x y) = e^{2x}$$

5.  **两边积分：** 对上式两边同时积分，得到：

    $$e^x y = \int e^{2x} dx + C = \frac{1}{2}e^{2x} + C$$

6.  **得到通解：**  将等式两边同时除以 $e^x$，得到通解为：

    $$y = \frac{1}{2}e^x + Ce^{-x}$$

7.  **代入初值条件：**  将初值条件 $y(0) = 1$ 代入通解，得到：

    $$1 = \frac{1}{2}e^0 + Ce^{-0} = \frac{1}{2} + C$$

    解得 $C = \frac{1}{2}$。

    因此，初值问题的特解为：

    $$y = \frac{1}{2}e^x + \frac{1}{2}e^{-x} = \frac{e^x + e^{-x}}{2} = \cosh x$$
    
    所以初值问题的特解为 $y=\cosh x$。

### 2.4 习题

1. 求解下列微分方程：
    *   (a) $\frac{dy}{dx} + \frac{1}{x}y = x^2$, $x>0$
    *   (b) $\frac{dy}{dx} - 2y = e^{3x}$
    *   (c) $y' + y\tan x = \sec x$
    *   (d) $x\frac{dy}{dx} + y = \sin x$, $x>0$

2. 求解下列初值问题：
    *   (a) $\frac{dy}{dx} - y = 1$, $y(0) = 0$
    *   (b) $\frac{dy}{dx} + \frac{2}{x}y = x$, $y(1) = 1$

3. 证明：如果 $y_1(x)$ 是非齐次线性方程 $\frac{dy}{dx} + P(x)y = Q(x)$ 的一个特解，$y_2(x)$ 是对应的齐次方程 $\frac{dy}{dx} + P(x)y = 0$ 的通解，则 $y(x) = y_1(x) + y_2(x)$ 是非齐次线性方程的通解。

### 2.5 可化为一阶线性微分方程的类型 (伯努利方程)

**2.5.1 定义**

在微分方程的世界里，除了可分离变量方程和线性方程，还有许多其他形式的方程。其中，**伯努利方程**是一种特殊类型，它虽然本身不是线性方程，但可以通过巧妙的变量代换，将其转化为一阶线性微分方程，从而可以使用线性方程的解法来求解。伯努利方程的一般形式如下：

$$\frac{dy}{dx} + P(x)y = Q(x)y^n$$

其中 $n$ 是一个实数，且满足 $n \neq 0$ 和 $n \neq 1$。$P(x)$ 和 $Q(x)$ 依然是关于 $x$ 的已知函数。
  
  特别地，当 $n=0$ 时，方程退化为 $\frac{dy}{dx} + P(x)y = Q(x)$，这是一个一阶线性非齐次方程。而当 $n=1$ 时，方程变为 $\frac{dy}{dx} + P(x)y = Q(x)y$，经过整理后可得 $\frac{dy}{dx} + (P(x)-Q(x))y=0$ ，这是一个一阶线性齐次方程，所以我们说伯努利方程中$n\ne 0$和$n\ne 1$。

**2.5.2 解法**

伯努利方程的解法依赖于一种巧妙的变量代换，其核心思想是将非线性项 $y^n$ 转换为线性形式。具体步骤如下：

1.  **变量代换:** 令 $z = y^{1-n}$，则通过链式法则，可以得到 $z$ 关于 $x$ 的导数：

    $$\frac{dz}{dx} = (1-n)y^{-n}\frac{dy}{dx}$$

2.  **改写原方程:** 将原伯努利方程两边同时乘以 $(1-n)y^{-n}$，得到：

    $$(1-n)y^{-n}\frac{dy}{dx} + (1-n)P(x)y^{1-n} = (1-n)Q(x)$$

3.  **代入新变量:** 将 $\frac{dz}{dx} = (1-n)y^{-n}\frac{dy}{dx}$ 和 $z = y^{1-n}$ 代入上式，得到：

    $$\frac{dz}{dx} + (1-n)P(x)z = (1-n)Q(x)$$

    这是一个关于 $z$ 的一阶线性微分方程，其中 $(1-n)P(x)$ 是新的 $P(x)$ 函数，$(1-n)Q(x)$ 是新的 $Q(x)$ 函数。

4.  **求解线性方程:**  使用 2.3 节介绍的方法求解关于 $z$ 的一阶线性微分方程，得到 $z$ 的通解，即得到关于 $z$ 和 $x$ 的函数关系。

5.  **回代原变量:** 将 $z = y^{1-n}$ 代回 $z$ 的通解，得到原伯努利方程关于 $y$ 的通解。这样，就完成了伯努利方程的求解。

**例 2.5.1** 求解微分方程 $\frac{dy}{dx} + \frac{1}{x}y = xy^2$。

**解：**

这是一个伯努利方程，其中 $n=2$, $P(x) = \frac{1}{x}$, $Q(x) = x$。

1.  **变量代换:** 令 $z = y^{1-2} = y^{-1}$，则 $\frac{dz}{dx} = -y^{-2}\frac{dy}{dx}$。

2.  **改写原方程:** 将原方程两边同时乘以 $-y^{-2}$，得到：

    $$-y^{-2}\frac{dy}{dx} - \frac{1}{x}y^{-1} = -x$$

3.  **代入新变量:** 将 $\frac{dz}{dx} = -y^{-2}\frac{dy}{dx}$ 和 $z = y^{-1}$ 代入上式，得到：

    $$\frac{dz}{dx} - \frac{1}{x}z = -x$$

4.  **求解线性方程:** 这是一个关于 $z$ 的一阶线性微分方程，其中 $P(x) = -\frac{1}{x}$, $Q(x) = -x$。首先计算积分因子：

    $$e^{\int P(x) dx} = e^{\int -\frac{1}{x} dx} = e^{-\ln x} = \frac{1}{x}$$

    将方程两边同时乘以积分因子 $\frac{1}{x}$，得到：

    $$\frac{1}{x}\frac{dz}{dx} - \frac{1}{x^2}z = -1$$

    注意到方程左边恰好是 $(\frac{1}{x}z)$ 的导数，因此可以写成：

    $$\frac{d}{dx}\left(\frac{1}{x}z\right) = -1$$

    两边积分：

    $$\frac{1}{x}z = -x + C$$

    解得：

    $$z = -x^2 + Cx$$

5.  **回代原变量:** 将 $z = y^{-1}$ 代回上式，得到：

    $$\frac{1}{y} = -x^2 + Cx$$

    因此，原方程的通解为：

    $$y = \frac{1}{Cx - x^2}$$

**例 2.5.2** 求解微分方程 $\frac{dy}{dx} - y = e^x y^3$。

**解：**

这是一个伯努利方程，其中 $n=3$, $P(x) = -1$, $Q(x) = e^x$。

1.  **变量代换:** 令 $z = y^{1-3} = y^{-2}$，则 $\frac{dz}{dx} = -2y^{-3}\frac{dy}{dx}$。

2.  **改写原方程:** 将原方程两边同时乘以 $-2y^{-3}$，得到：

    $$-2y^{-3}\frac{dy}{dx} + 2y^{-2} = -2e^x$$

3.  **代入新变量:** 将 $\frac{dz}{dx} = -2y^{-3}\frac{dy}{dx}$ 和 $z = y^{-2}$ 代入上式，得到：

    $$\frac{dz}{dx} + 2z = -2e^x$$

4.  **求解线性方程:** 这是一个关于 $z$ 的一阶线性微分方程，其中 $P(x) = 2$, $Q(x) = -2e^x$。首先计算积分因子：

    $$e^{\int P(x) dx} = e^{\int 2 dx} = e^{2x}$$

    将方程两边同时乘以积分因子 $e^{2x}$，得到：

    $$e^{2x}\frac{dz}{dx} + 2e^{2x}z = -2e^{3x}$$

    注意到方程左边恰好是 $(e^{2x}z)$ 的导数，因此可以写成：

    $$\frac{d}{dx}\left(e^{2x}z\right) = -2e^{3x}$$

    两边积分：

    $$e^{2x}z = -\frac{2}{3}e^{3x} + C$$

    解得：

    $$z = -\frac{2}{3}e^x + Ce^{-2x}$$

5.  **回代原变量:** 将 $z = y^{-2}$ 代回上式，得到：

    $$y^{-2} = -\frac{2}{3}e^x + Ce^{-2x}$$

    因此，原方程的通解为：

    $$y^2 = \frac{1}{Ce^{-2x} - \frac{2}{3}e^x}$$

### 2.6 习题

1.  求解下列微分方程：
    *   (a) $\frac{dy}{dx} + y = xy^3$
    *   (b) $\frac{dy}{dx} - \frac{1}{x}y = x^2 y^2$
    *   (c) $x\frac{dy}{dx} + y = y^2 \ln x$, $x>0$
2.  求解初值问题：
    *   (a) $\frac{dy}{dx} - 2xy = xy^2$, $y(0) = 1$

### 2.6 恰当方程 (选学)

**注意：** 本节内容涉及到一些多元函数微积分的知识，大学一年级第一学期的学生可能尚未学习过相关内容。建议学生在学习了多元函数微积分之后再来学习本节内容，或者选学本节内容。

**2.6.1 引入**

在研究微分方程的过程中，我们经常会遇到一种形式特殊的方程，即**恰当方程**。恰当方程是可以通过求全微分直接求解的方程类型，它与多元函数微积分中的全微分概念紧密相连。考虑一个一阶微分方程，它可以写成如下形式：

$$M(x, y) dx + N(x, y) dy = 0$$

其中 $M(x, y)$ 和 $N(x, y)$ 是关于 $x$ 和 $y$ 的函数。

如果存在一个二元函数 $u(x, y)$，使得它的“全微分”恰好等于方程的左边，即：

$$du = \frac{\partial u}{\partial x} dx + \frac{\partial u}{\partial y} dy = M(x, y) dx + N(x, y) dy$$

那么我们就称这个方程为**恰当方程**，或者**全微分方程**。

**说明：**  这里的“$\frac{\partial u}{\partial x}$” 和 “$\frac{\partial u}{\partial y}$” 分别表示函数 $u$ 对 $x$ 和 $y$ 的“偏导数”，它们可以理解为分别将 $y$ 和 $x$ 当作常数时，$u$ 对 $x$ 和 $y$ 的导数。由于读者可能还没有学习过多元函数的微积分，这里我们暂不深入解释偏导数的概念，而是**将重点放在如何判断一个方程是否是恰当方程，以及如何求解恰当方程上。**

**2.6.2 恰当方程的判定**

在微积分中有一个重要的结论：如果函数 $u(x,y)$ 具有连续的二阶偏导数，那么它的混合偏导数与求导次序无关，即：

$$\frac{\partial^2 u}{\partial y \partial x} = \frac{\partial^2 u}{\partial x \partial y}$$

利用这个结论，我们可以得到一个判断方程 $M(x,y)dx + N(x,y)dy = 0$ 是否为恰当方程的简便方法：

**定理：** 如果函数 $M(x, y)$ 和 $N(x, y)$ 在某个区域内具有连续的偏导数，且满足

$$\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$$

那么方程 $M(x,y)dx + N(x,y)dy = 0$ 在该区域内是一个恰当方程。

**说明：** 尽管我们还没有学习偏导数的计算方法，但对于一些简单的二元函数，例如 $M(x,y) = x^2 + y^2$，我们可以将其中的 $y$ 当作常数，然后对 $x$ 求导，得到 $\frac{\partial M}{\partial x} = 2x$；类似地，将 $x$ 当作常数，对 $y$ 求导，得到 $\frac{\partial M}{\partial y} = 2y$。
这个定理提供了一个简单易行的检验方法，只需计算 $M$ 对 $y$ 的偏导数和 $N$ 对 $x$ 的偏导数，如果两者相等，则方程是恰当方程。

**2.6.3 恰当方程的解法**

如果方程 $M(x,y)dx + N(x,y)dy = 0$ 是一个恰当方程，那么根据定义，存在一个函数 $u(x,y)$，使得

$$du = M(x, y) dx + N(x, y) dy = 0$$

因此，方程的通解可以写成：

$$u(x, y) = C$$

其中 $C$ 是任意常数。
这个方程实际上描述了一个二元函数 $u(x,y)$ 在平面上取值为常数时形成的曲线族。

那么如何找到这个函数 $u(x,y)$ 呢？我们可以通过以下步骤来求解：

1.  **利用 $M(x,y)$ 对 $x$ 的“偏积分”得到 $u$ 的一部分:**  因为 $\frac{\partial u}{\partial x} = M(x,y)$，我们可以将 $y$ 当作常数，对 $M(x,y)$ 关于 $x$ 进行“积分”，得到：

    $$u(x,y) = \int M(x,y) dx + \phi(y)$$

    其中 $\phi(y)$ 是一个只关于 $y$ 的待定函数，它的存在是由于偏积分时，y被看做常数。
    注意，这里的积分是对 $x$ 的积分，因此，我们只考虑 $x$ 的函数，对于 $y$ 的函数都看作常数。
    
2.  **利用 $N(x,y)$ 确定 $\phi(y)$:**  因为 $\frac{\partial u}{\partial y} = N(x,y)$，我们将上一步得到的 $u(x,y)$ 对 $y$ 求“偏导数”，得到：

    $$\frac{\partial u}{\partial y} = \frac{\partial}{\partial y} \left( \int M(x,y) dx \right) + \phi'(y) = N(x,y)$$

    通过比较上式和 $N(x,y)$，我们可以确定 $\phi'(y)$，进而求得 $\phi(y)$。 此时我们可以利用偏导数的性质，将积分符号和偏导数符号交换顺序，再进行计算。
    
3.  **写出通解:** 将 $\phi(y)$ 代回 $u(x,y)$ 的表达式，得到原方程的通解 $u(x,y) = C$。这样，我们就得到了恰当方程的解。

**例 2.6.1** 求解微分方程 $(2xy + 1)dx + (x^2 + 2y)dy = 0$。

**解：**

这里 $M(x,y) = 2xy + 1$, $N(x,y) = x^2 + 2y$。

1. **判断是否为恰当方程：** 首先判断方程是否为恰当方程：

    $$\frac{\partial M}{\partial y} = 2x, \quad \frac{\partial N}{\partial x} = 2x$$

    因为 $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$，所以该方程是一个恰当方程。

2. **求 $u$ 的一部分：** 利用 $M(x,y)$ 对 $x$ 的偏积分，求 $u(x,y)$ 的一部分：

    $$u(x,y) = \int M(x,y) dx = \int (2xy + 1) dx = x^2y + x + \phi(y)$$
    
    注意，这里我们将 $y$ 看作常数。
    

3.  **确定 $\phi(y)$：**  利用 $N(x,y)$ 确定 $\phi(y)$，对上一步得到的$u(x,y)$关于$y$求偏导数：
    
    $$\frac{\partial u}{\partial y} = x^2 + \phi'(y) = N(x,y) = x^2 + 2y$$

    比较可知 $\phi'(y) = 2y$，因此 $\phi(y) = y^2$ (这里我们省略了积分常数，因为我们只需要找到一个 $\phi(y)$ 即可)。

4.  **写出通解：**  将 $\phi(y)$ 代回 $u(x,y)$ 的表达式，得到：

    $$u(x,y) = x^2y + x + y^2 = C$$

    因此，原方程的通解为 $x^2y + x + y^2 = C$。

**2.6.4 说明**

对于更复杂的恰当方程，可能需要使用一些积分技巧来求解 $u(x,y)$。另外，有些方程本身不是恰当方程，但可以通过乘以一个适当的函数 (积分因子) 将其转化为恰当方程，这部分内容我们将在后续的章节中介绍。
恰当方程的解法，关键在于找到函数$u(x,y)$，使得它的全微分等于微分方程左侧部分，这个过程需要一些技巧和经验，但它也是我们理解微分方程本质的一个关键。

### 2.7 习题

1.  判断下列方程是否为恰当方程：
    *   (a) $(2x+y)dx + (x+2y)dy = 0$
    *   (b) $(x^2-y)dx + (y^2-x)dy = 0$
    *   (c) $y dx - x dy = 0$

2.  求解下列恰当方程：
    *   (a) $(2x+3y)dx + (3x+4y)dy = 0$
    *   (b) $(\cos x - \sin x \sin y) dx + (\cos x \cos y) dy = 0$

好的！ 感谢你的认可，我会继续按照这个思路编写后续内容。

在讲解完可化为一阶线性微分方程的类型——伯努利方程以及恰当方程后，按照循序渐进的原则，接下来我们应该讲解 **2.7 一阶微分方程的积分因子**。 虽然恰当方程也属于可以使用积分因子求解的类型，但考虑到这是初学者第一次接触积分因子，我打算将其作为一个单独的章节，重点讲解积分因子的基本概念、常见类型以及求解方法，并配以例题进行说明。

由于积分因子的内容相对独立，因此即使学生跳过了前面的“恰当方程”这一节，也能够理解和掌握积分因子的基本概念和求解方法。

---

### 2.8 一阶微分方程的积分因子

**2.8.1 引入**

对于一个一阶微分方程

$$M(x, y) dx + N(x, y) dy = 0$$

如果它不是恰当方程，即 $\frac{\partial M}{\partial y} \neq \frac{\partial N}{\partial x}$，那么我们是否可以找到一个函数 $\mu(x, y)$，使得方程两边同时乘以 $\mu(x, y)$ 后变成一个恰当方程呢？ 也就是说，我们需要找到一个 $\mu(x, y)$，使得

$$\mu(x, y) M(x, y) dx + \mu(x, y) N(x, y) dy = 0$$

成为一个恰当方程。这样的函数 $\mu(x, y)$ 就称为原方程的**积分因子**。积分因子的引入，为我们求解非恰当方程提供了一种重要的途径。

**2.8.2 积分因子的定义**

如果存在一个非零函数 $\mu(x,y)$，使得方程

$$\mu(x,y)M(x,y)dx + \mu(x,y)N(x,y)dy = 0$$

是一个恰当方程，则称 $\mu(x,y)$ 为微分方程 $M(x,y)dx + N(x,y)dy = 0$ 的一个**积分因子**。
换句话说，积分因子的作用是“纠正”非恰当方程，使其满足恰当方程的条件，从而可以利用全微分的性质进行求解。

**2.8.3 积分因子的判定条件**

根据恰当方程的判定条件，方程 $\mu M dx + \mu N dy = 0$ 是恰当方程的充分必要条件是：

$$\frac{\partial (\mu M)}{\partial y} = \frac{\partial (\mu N)}{\partial x}$$

展开得到：

$$\mu \frac{\partial M}{\partial y} + M \frac{\partial \mu}{\partial y} = \mu \frac{\partial N}{\partial x} + N \frac{\partial \mu}{\partial x}$$

这就是 $\mu(x,y)$ 应该满足的条件。然而，这是一个关于 $\mu$ 的偏微分方程，通常情况下求解这个方程比求解原方程更困难。这使得寻找一般的积分因子变得非常具有挑战性。
尽管如此，在一些特殊情况下，我们仍然能够找到一些特定类型的积分因子，例如，只与 $x$ 或只与 $y$ 有关的积分因子，这些特殊形式的积分因子在实际应用中非常重要。

**2.8.4 几种特殊类型的积分因子**

在某些特殊情况下，我们可以找到只与 $x$ 或 $y$ 有关的积分因子。
这些特殊类型的积分因子的存在，使得我们可以通过更简单的方式求解一部分非恰当方程。

**(1) 积分因子只与 $x$ 有关**

假设积分因子 $\mu$ 只与 $x$ 有关，即 $\mu = \mu(x)$，那么 $\frac{\partial \mu}{\partial y} = 0$。代入上面的判定条件，得到：

$$\mu \frac{\partial M}{\partial y} = \mu \frac{\partial N}{\partial x} + N \frac{d\mu}{dx}$$

$$\frac{1}{\mu} \frac{d\mu}{dx} = \frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right)$$

如果 $\frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right)$ 只与 $x$ 有关，记作 $\phi(x)$，即

$$\phi(x) = \frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right)$$

那么我们有：

$$\frac{1}{\mu} \frac{d\mu}{dx} = \phi(x)$$

$$\frac{d\mu}{\mu} = \phi(x) dx$$

两边积分，得到：

$$\ln |\mu| = \int \phi(x) dx$$

$$\mu(x) = e^{\int \phi(x) dx}$$

因此，如果 $\frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right)$ 只与 $x$ 有关，那么我们可以找到一个只与 $x$ 有关的积分因子 $\mu(x) = e^{\int \phi(x) dx}$。
这个公式告诉我们，当 $\frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right)$ 只与 $x$ 有关时，积分因子是它的积分的指数函数形式。

**(2) 积分因子只与 $y$ 有关**

类似地，假设积分因子 $\mu$ 只与 $y$ 有关，即 $\mu = \mu(y)$，那么 $\frac{\partial \mu}{\partial x} = 0$。代入判定条件，得到：

$$\mu \frac{\partial M}{\partial y} + M \frac{d\mu}{dy} = \mu \frac{\partial N}{\partial x}$$

$$\frac{1}{\mu} \frac{d\mu}{dy} = \frac{1}{M} \left( \frac{\partial N}{\partial x} - \frac{\partial M}{\partial y} \right)$$

如果 $\frac{1}{M} \left( \frac{\partial N}{\partial x} - \frac{\partial M}{\partial y} \right)$ 只与 $y$ 有关，记作 $\psi(y)$, 即

$$\psi(y) = \frac{1}{M} \left( \frac{\partial N}{\partial x} - \frac{\partial M}{\partial y} \right)$$

那么我们有：

$$\frac{1}{\mu} \frac{d\mu}{dy} = \psi(y)$$

$$\frac{d\mu}{\mu} = \psi(y) dy$$

两边积分，得到：

$$\ln |\mu| = \int \psi(y) dy$$

$$\mu(y) = e^{\int \psi(y) dy}$$

因此，如果 $\frac{1}{M} \left( \frac{\partial N}{\partial x} - \frac{\partial M}{\partial y} \right)$ 只与 $y$ 有关，那么我们可以找到一个只与 $y$ 有关的积分因子 $\mu(y) = e^{\int \psi(y) dy}$。
与只与 $x$ 有关的积分因子类似，当 $\frac{1}{M} \left( \frac{\partial N}{\partial x} - \frac{\partial M}{\partial y} \right)$ 只与 $y$ 有关时，积分因子是它的积分的指数函数形式。

**例 2.8.1** 求解微分方程 $(2xy^2 - y)dx + xdy = 0$。

**解：**

这里 $M(x,y) = 2xy^2 - y$, $N(x,y) = x$。

1.  **验证非恰当性:** 首先，计算偏导数：

    $$\frac{\partial M}{\partial y} = 4xy - 1, \quad \frac{\partial N}{\partial x} = 1$$

    因为 $\frac{\partial M}{\partial y} \neq \frac{\partial N}{\partial x}$，所以该方程不是恰当方程。

2.  **尝试寻找只与 $x$ 有关的积分因子：**  计算 $\phi(x)$：

    $$\phi(x) = \frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right) = \frac{1}{x}(4xy - 1 - 1) = \frac{4xy - 2}{x} = 4y - \frac{2}{x}$$

    由于 $\phi(x)$ 包含了 $y$，所以不存在只与 $x$ 有关的积分因子。

3.  **尝试寻找只与 $y$ 有关的积分因子：**  计算 $\psi(y)$：

    $$\psi(y) = \frac{1}{M} \left( \frac{\partial N}{\partial x} - \frac{\partial M}{\partial y} \right) = \frac{1}{2xy^2 - y}(1 - (4xy - 1)) = \frac{2 - 4xy}{y(2xy - 1)} = -\frac{2}{y}$$

    由于 $\psi(y)$ 只与 $y$ 有关，所以存在只与 $y$ 有关的积分因子。

4.  **计算积分因子:** 计算积分因子 $\mu(y)$：

    $$\mu(y) = e^{\int \psi(y) dy} = e^{\int -\frac{2}{y} dy} = e^{-2\ln y} = y^{-2}$$

5.  **乘以积分因子:** 将原方程两边同时乘以积分因子 $\mu(y) = y^{-2}$，得到：

    $$(2x - \frac{1}{y})dx + \frac{x}{y^2}dy = 0$$

6.  **验证恰当性：** 此时 $M_1(x,y) = 2x - \frac{1}{y}$, $N_1(x,y) = \frac{x}{y^2}$，计算偏导数：
    
    $$\frac{\partial M_1}{\partial y} = \frac{1}{y^2}, \quad \frac{\partial N_1}{\partial x} = \frac{1}{y^2}$$
    
    因为$\frac{\partial M_1}{\partial y} = \frac{\partial N_1}{\partial x}$，因此这是一个恰当方程。

7.  **求解恰当方程：** 接下来求解这个恰当方程：

    1. **求 $u$ 的一部分：**

        $$u(x,y) = \int M_1(x,y) dx = \int (2x - \frac{1}{y}) dx = x^2 - \frac{x}{y} + \phi(y)$$

    2.  **确定 $\phi(y)$：**

        $$\frac{\partial u}{\partial y} = \frac{x}{y^2} + \phi'(y) = N_1(x,y) = \frac{x}{y^2}$$

        比较可知 $\phi'(y) = 0$，因此 $\phi(y) = C_1$ (常数)。

    3.  **写出通解：**

        $$u(x,y) = x^2 - \frac{x}{y} = C$$

    因此，原方程的通解为 $x^2 - \frac{x}{y} = C$。

**2.8.5 说明**

积分因子法是一种非常重要的求解微分方程的方法，但寻找积分因子通常比较困难。除了上述介绍的两种特殊类型的积分因子外，还有其他类型的积分因子，例如可以通过观察法、分组法等方法来寻找积分因子。 这需要大量的练习和经验积累。
积分因子的概念是微分方程求解中一个非常重要的工具，它使得我们可以将一些非恰当方程转化为恰当方程进行求解。然而，寻找积分因子本身也是一项挑战，需要对微分方程的结构有深入的了解，并掌握相关的技巧。

### 2.9 习题

1.  验证下列方程存在只与 $x$ 或 $y$ 有关的积分因子，并求出积分因子：
    *   (a) $(x^2 + y^2 + x)dx + xydy = 0$
    *   (b) $(3x^2y + y^2)dx + (x^3 + 2xy)dy = 0$

2.  使用积分因子法求解下列微分方程：
    *   (a) $(e^x \sin y - y)dx + (e^x \cos y + x)dy = 0$
    *   (b) $(2y^2+3x)dx + 2xydy = 0$

